<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>이미지 업로드</title>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <style>
    #preview {
      margin-top: 20px;
      max-width: 100%;
      height: auto;
    }
    .error {
      color: red;
    }
  </style>
</head>
<body>

  <h1>이미지 업로드</h1>
  
  <input type="file" id="imageUpload" accept="image/jpeg, image/png">
  <div id="error" class="error"></div>
  <div id="imageDetails"></div>
  <img id="preview" src="" alt="미리보기 이미지" style="display: none;"/>

  <script>
    $(document).ready(function() {
      // 변수 선언
      let imageBase64 = '';
      let imageRatio = '';

      // 파일 업로드 처리
      $('#imageUpload').on('change', function(e) {
        const file = e.target.files[0];
        
        if (file) {
          const fileType = file.type.split('/')[1];
          const fileSize = file.size / 1024 / 1024; // MB 단위로 변환
          
          // 이미지 파일 형식 체크 (jpg, png만 허용)
          if (fileType !== 'jpeg' && fileType !== 'png') {
            $('#error').text('JPEG 또는 PNG 형식의 이미지 파일만 업로드 가능합니다.');
            $('#preview').hide();
            return;
          }
          
          // 파일 크기 체크 (2MB 이하)
          if (fileSize > 2) {
            $('#error').text('이미지 크기는 2MB 이하만 업로드 가능합니다.');
            $('#preview').hide();
            return;
          }

          // 에러 메시지 초기화
          $('#error').text('');

          // 파일을 Base64로 변환
          const reader = new FileReader();
          reader.onload = function(event) {
            imageBase64 = event.target.result;  // Base64 데이터
            $('#preview').attr('src', imageBase64).show();

            // 이미지 비율 계산
            const img = new Image();
            img.onload = function() {
              const width = img.width;
              const height = img.height;
              imageRatio = (width / height).toFixed(2);  // 비율 계산

              // 이미지 비율과 기타 정보 출력
              $('#imageDetails').html(`
                <p>이미지 비율: ${imageRatio}</p>
                <p>이미지 크기: ${fileSize.toFixed(2)} MB</p>
              `);
            };
            img.src = imageBase64; // 이미지 로드
          };
          reader.readAsDataURL(file);  // Base64로 파일 읽기
        }
      });
    });
  </script>

</body>
</html>
